namespace Octokit.GraphQL.Model
{
    using System;
    using System.Collections.Generic;
    using System.Linq.Expressions;
    using Octokit.GraphQL.Core;
    using Octokit.GraphQL.Core.Builders;

    /// <summary>
    /// A alert for a repository with an affected vulnerability.
    /// </summary>
    public class RepositoryVulnerabilityAlert : QueryableValue<RepositoryVulnerabilityAlert>
    {
        internal RepositoryVulnerabilityAlert(Expression expression) : base(expression)
        {
        }

        /// <summary>
        /// The affected version
        /// </summary>
        [Obsolete(@"advisory specific fields are being removed from repositoryVulnerabilityAlert objects Use `securityVulnerability.vulnerableVersionRange` instead. Removal on 2019-10-01 UTC.")]
        public string AffectedRange { get; }

        /// <summary>
        /// When was the alert created?
        /// </summary>
        public DateTimeOffset CreatedAt { get; }

        /// <summary>
        /// The reason the alert was dismissed
        /// </summary>
        public string DismissReason { get; }

        /// <summary>
        /// When was the alert dimissed?
        /// </summary>
        public DateTimeOffset? DismissedAt { get; }

        /// <summary>
        /// The user who dismissed the alert
        /// </summary>
        public User Dismisser => this.CreateProperty(x => x.Dismisser, Octokit.GraphQL.Model.User.Create);

        /// <summary>
        /// The external identifier for the vulnerability
        /// </summary>
        [Obsolete(@"advisory specific fields are being removed from repositoryVulnerabilityAlert objects Use `securityAdvisory.identifiers` instead. Removal on 2019-10-01 UTC.")]
        public string ExternalIdentifier { get; }

        /// <summary>
        /// The external reference for the vulnerability
        /// </summary>
        [Obsolete(@"advisory specific fields are being removed from repositoryVulnerabilityAlert objects Use `securityAdvisory.references` instead. Removal on 2019-10-01 UTC.")]
        public string ExternalReference { get; }

        /// <summary>
        /// The fixed version
        /// </summary>
        [Obsolete(@"advisory specific fields are being removed from repositoryVulnerabilityAlert objects Use `securityVulnerability.firstPatchedVersion` instead. Removal on 2019-10-01 UTC.")]
        public string FixedIn { get; }

        public string Id { get; }

        /// <summary>
        /// The affected package
        /// </summary>
        [Obsolete(@"advisory specific fields are being removed from repositoryVulnerabilityAlert objects Use `securityVulnerability.package` instead. Removal on 2019-10-01 UTC.")]
        public string PackageName { get; }

        /// <summary>
        /// The associated repository
        /// </summary>
        public Repository Repository => this.CreateProperty(x => x.Repository, Octokit.GraphQL.Model.Repository.Create);

        /// <summary>
        /// The associated security advisory
        /// </summary>
        public SecurityAdvisory SecurityAdvisory => this.CreateProperty(x => x.SecurityAdvisory, Octokit.GraphQL.Model.SecurityAdvisory.Create);

        /// <summary>
        /// The associated security vulnerablity
        /// </summary>
        public SecurityVulnerability SecurityVulnerability => this.CreateProperty(x => x.SecurityVulnerability, Octokit.GraphQL.Model.SecurityVulnerability.Create);

        /// <summary>
        /// The vulnerable manifest filename
        /// </summary>
        public string VulnerableManifestFilename { get; }

        /// <summary>
        /// The vulnerable manifest path
        /// </summary>
        public string VulnerableManifestPath { get; }

        /// <summary>
        /// The vulnerable requirements
        /// </summary>
        public string VulnerableRequirements { get; }

        internal static RepositoryVulnerabilityAlert Create(Expression expression)
        {
            return new RepositoryVulnerabilityAlert(expression);
        }
    }
}